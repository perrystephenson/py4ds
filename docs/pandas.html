<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Python for Data Science</title>
  <meta name="description" content="Python for Data Science">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Python for Data Science" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Python for Data Science" />
  
  
  

<meta name="author" content="Perry Stephenson">


<meta name="date" content="2018-11-04">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="numpy-numeric-python.html">
<link rel="next" href="visualisation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Python for Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-is-python"><i class="fa fa-check"></i><b>1.1</b> What is Python?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#setting-up-python"><i class="fa fa-check"></i><b>1.2</b> Setting up Python</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#getting-help"><i class="fa fa-check"></i><b>1.3</b> Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="syntax.html"><a href="syntax.html"><i class="fa fa-check"></i><b>2</b> Base Syntax</a><ul>
<li class="chapter" data-level="2.1" data-path="syntax.html"><a href="syntax.html#types"><i class="fa fa-check"></i><b>2.1</b> Types</a></li>
<li class="chapter" data-level="2.2" data-path="syntax.html"><a href="syntax.html#comments"><i class="fa fa-check"></i><b>2.2</b> Comments</a></li>
<li class="chapter" data-level="2.3" data-path="syntax.html"><a href="syntax.html#basic-operations"><i class="fa fa-check"></i><b>2.3</b> Basic Operations</a></li>
<li class="chapter" data-level="2.4" data-path="syntax.html"><a href="syntax.html#strings"><i class="fa fa-check"></i><b>2.4</b> Strings</a></li>
<li class="chapter" data-level="2.5" data-path="syntax.html"><a href="syntax.html#type-casting"><i class="fa fa-check"></i><b>2.5</b> Type Casting</a></li>
<li class="chapter" data-level="2.6" data-path="syntax.html"><a href="syntax.html#lists-arrays-columns-vectors"><i class="fa fa-check"></i><b>2.6</b> Lists / Arrays / Columns / Vectors</a></li>
<li class="chapter" data-level="2.7" data-path="syntax.html"><a href="syntax.html#indexing"><i class="fa fa-check"></i><b>2.7</b> Indexing</a></li>
<li class="chapter" data-level="2.8" data-path="syntax.html"><a href="syntax.html#copy-modify"><i class="fa fa-check"></i><b>2.8</b> Copy / Modify</a></li>
<li class="chapter" data-level="2.9" data-path="syntax.html"><a href="syntax.html#grouping"><i class="fa fa-check"></i><b>2.9</b> Grouping</a></li>
<li class="chapter" data-level="2.10" data-path="syntax.html"><a href="syntax.html#missing-values-and-extreme-numbers"><i class="fa fa-check"></i><b>2.10</b> Missing values and extreme numbers</a></li>
<li class="chapter" data-level="2.11" data-path="syntax.html"><a href="syntax.html#booleans"><i class="fa fa-check"></i><b>2.11</b> Booleans</a></li>
<li class="chapter" data-level="2.12" data-path="syntax.html"><a href="syntax.html#dictionaries"><i class="fa fa-check"></i><b>2.12</b> Dictionaries</a></li>
<li class="chapter" data-level="2.13" data-path="syntax.html"><a href="syntax.html#functions"><i class="fa fa-check"></i><b>2.13</b> Functions</a><ul>
<li class="chapter" data-level="2.13.1" data-path="syntax.html"><a href="syntax.html#lambda-functions"><i class="fa fa-check"></i><b>2.13.1</b> Lambda functions</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="syntax.html"><a href="syntax.html#methods"><i class="fa fa-check"></i><b>2.14</b> Methods</a></li>
<li class="chapter" data-level="2.15" data-path="syntax.html"><a href="syntax.html#namespaces"><i class="fa fa-check"></i><b>2.15</b> Namespaces</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html"><i class="fa fa-check"></i><b>3</b> Importing and Exporting</a><ul>
<li class="chapter" data-level="3.1" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#opening-text-files"><i class="fa fa-check"></i><b>3.1</b> Opening Text Files</a><ul>
<li class="chapter" data-level="3.1.1" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#plain-text"><i class="fa fa-check"></i><b>3.1.1</b> Plain Text</a></li>
<li class="chapter" data-level="3.1.2" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#tabular-data"><i class="fa fa-check"></i><b>3.1.2</b> Tabular Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#relational-databases"><i class="fa fa-check"></i><b>3.2</b> Relational Databases</a><ul>
<li class="chapter" data-level="3.2.1" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#using-sqlalchemy"><i class="fa fa-check"></i><b>3.2.1</b> Using SQLAlchemy</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#exotic-filetypes"><i class="fa fa-check"></i><b>3.3</b> Exotic Filetypes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#excel"><i class="fa fa-check"></i><b>3.3.1</b> Excel</a></li>
<li class="chapter" data-level="3.3.2" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#pickle-serialised"><i class="fa fa-check"></i><b>3.3.2</b> Pickle (serialised)</a></li>
<li class="chapter" data-level="3.3.3" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#hdf5"><i class="fa fa-check"></i><b>3.3.3</b> HDF5</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#working-with-the-file-system"><i class="fa fa-check"></i><b>3.4</b> Working with the file system</a></li>
<li class="chapter" data-level="3.5" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#retrieving-files-from-the-web"><i class="fa fa-check"></i><b>3.5</b> Retrieving files from the web</a><ul>
<li class="chapter" data-level="3.5.1" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#working-with-http-requests-directly"><i class="fa fa-check"></i><b>3.5.1</b> Working with HTTP requests directly</a></li>
<li class="chapter" data-level="3.5.2" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#using-the-requests-package"><i class="fa fa-check"></i><b>3.5.2</b> Using the requests package</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#parsing-html"><i class="fa fa-check"></i><b>3.6</b> Parsing HTML</a></li>
<li class="chapter" data-level="3.7" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#working-with-json"><i class="fa fa-check"></i><b>3.7</b> Working with JSON</a></li>
<li class="chapter" data-level="3.8" data-path="importing-and-exporting.html"><a href="importing-and-exporting.html#working-with-apis"><i class="fa fa-check"></i><b>3.8</b> Working with APIs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>4</b> Control Flow</a><ul>
<li class="chapter" data-level="4.1" data-path="control-flow.html"><a href="control-flow.html#if-statements"><i class="fa fa-check"></i><b>4.1</b> If statements</a></li>
<li class="chapter" data-level="4.2" data-path="control-flow.html"><a href="control-flow.html#while-loop"><i class="fa fa-check"></i><b>4.2</b> While loop</a></li>
<li class="chapter" data-level="4.3" data-path="control-flow.html"><a href="control-flow.html#for-loop"><i class="fa fa-check"></i><b>4.3</b> For loop</a></li>
<li class="chapter" data-level="4.4" data-path="control-flow.html"><a href="control-flow.html#error-handling"><i class="fa fa-check"></i><b>4.4</b> Error Handling</a></li>
<li class="chapter" data-level="4.5" data-path="control-flow.html"><a href="control-flow.html#iterators-and-iterables"><i class="fa fa-check"></i><b>4.5</b> Iterators and Iterables</a><ul>
<li class="chapter" data-level="4.5.1" data-path="control-flow.html"><a href="control-flow.html#enumerate"><i class="fa fa-check"></i><b>4.5.1</b> Enumerate</a></li>
<li class="chapter" data-level="4.5.2" data-path="control-flow.html"><a href="control-flow.html#zip"><i class="fa fa-check"></i><b>4.5.2</b> Zip</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="control-flow.html"><a href="control-flow.html#list-comprehensions"><i class="fa fa-check"></i><b>4.6</b> List Comprehensions</a></li>
<li class="chapter" data-level="4.7" data-path="control-flow.html"><a href="control-flow.html#generators"><i class="fa fa-check"></i><b>4.7</b> Generators</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="scripting.html"><a href="scripting.html"><i class="fa fa-check"></i><b>5</b> Scripting</a><ul>
<li class="chapter" data-level="5.1" data-path="scripting.html"><a href="scripting.html#imports"><i class="fa fa-check"></i><b>5.1</b> Imports</a></li>
<li class="chapter" data-level="5.2" data-path="scripting.html"><a href="scripting.html#boilerplate"><i class="fa fa-check"></i><b>5.2</b> Boilerplate</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="numpy-numeric-python.html"><a href="numpy-numeric-python.html"><i class="fa fa-check"></i><b>6</b> Numpy (Numeric Python)</a><ul>
<li class="chapter" data-level="6.1" data-path="numpy-numeric-python.html"><a href="numpy-numeric-python.html#numpy-arrays-1"><i class="fa fa-check"></i><b>6.1</b> Numpy arrays</a></li>
<li class="chapter" data-level="6.2" data-path="numpy-numeric-python.html"><a href="numpy-numeric-python.html#two-dimensional-numpy-arrays"><i class="fa fa-check"></i><b>6.2</b> Two dimensional numpy arrays</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pandas.html"><a href="pandas.html"><i class="fa fa-check"></i><b>7</b> Pandas</a><ul>
<li class="chapter" data-level="7.1" data-path="pandas.html"><a href="pandas.html#creation"><i class="fa fa-check"></i><b>7.1</b> Creation</a></li>
<li class="chapter" data-level="7.2" data-path="pandas.html"><a href="pandas.html#subsetting"><i class="fa fa-check"></i><b>7.2</b> Subsetting</a></li>
<li class="chapter" data-level="7.3" data-path="pandas.html"><a href="pandas.html#reading-in-chunks"><i class="fa fa-check"></i><b>7.3</b> Reading in chunks</a></li>
<li class="chapter" data-level="7.4" data-path="pandas.html"><a href="pandas.html#working-with-dataframes"><i class="fa fa-check"></i><b>7.4</b> Working with DataFrames</a><ul>
<li class="chapter" data-level="7.4.1" data-path="pandas.html"><a href="pandas.html#basics"><i class="fa fa-check"></i><b>7.4.1</b> Basics</a></li>
<li class="chapter" data-level="7.4.2" data-path="pandas.html"><a href="pandas.html#selecting-columns"><i class="fa fa-check"></i><b>7.4.2</b> Selecting Columns</a></li>
<li class="chapter" data-level="7.4.3" data-path="pandas.html"><a href="pandas.html#counting-values"><i class="fa fa-check"></i><b>7.4.3</b> Counting Values</a></li>
<li class="chapter" data-level="7.4.4" data-path="pandas.html"><a href="pandas.html#plotting-things"><i class="fa fa-check"></i><b>7.4.4</b> Plotting Things</a></li>
<li class="chapter" data-level="7.4.5" data-path="pandas.html"><a href="pandas.html#reshaping-data-tidy-data"><i class="fa fa-check"></i><b>7.4.5</b> Reshaping Data (Tidy Data)</a></li>
<li class="chapter" data-level="7.4.6" data-path="pandas.html"><a href="pandas.html#chaining-methods"><i class="fa fa-check"></i><b>7.4.6</b> Chaining methods</a></li>
<li class="chapter" data-level="7.4.7" data-path="pandas.html"><a href="pandas.html#concatenation"><i class="fa fa-check"></i><b>7.4.7</b> Concatenation</a></li>
<li class="chapter" data-level="7.4.8" data-path="pandas.html"><a href="pandas.html#joining-merging"><i class="fa fa-check"></i><b>7.4.8</b> Joining (Merging)</a></li>
<li class="chapter" data-level="7.4.9" data-path="pandas.html"><a href="pandas.html#types-1"><i class="fa fa-check"></i><b>7.4.9</b> Types</a></li>
<li class="chapter" data-level="7.4.10" data-path="pandas.html"><a href="pandas.html#apply"><i class="fa fa-check"></i><b>7.4.10</b> Apply</a></li>
<li class="chapter" data-level="7.4.11" data-path="pandas.html"><a href="pandas.html#duplicates"><i class="fa fa-check"></i><b>7.4.11</b> Duplicates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>8</b> Visualisation</a><ul>
<li class="chapter" data-level="8.1" data-path="visualisation.html"><a href="visualisation.html#matplotlib"><i class="fa fa-check"></i><b>8.1</b> Matplotlib</a></li>
<li class="chapter" data-level="8.2" data-path="visualisation.html"><a href="visualisation.html#line-plot"><i class="fa fa-check"></i><b>8.2</b> Line Plot</a></li>
<li class="chapter" data-level="8.3" data-path="visualisation.html"><a href="visualisation.html#scatter-plot"><i class="fa fa-check"></i><b>8.3</b> Scatter Plot</a></li>
<li class="chapter" data-level="8.4" data-path="visualisation.html"><a href="visualisation.html#text"><i class="fa fa-check"></i><b>8.4</b> Text</a></li>
<li class="chapter" data-level="8.5" data-path="visualisation.html"><a href="visualisation.html#histograms"><i class="fa fa-check"></i><b>8.5</b> Histograms</a></li>
<li class="chapter" data-level="8.6" data-path="visualisation.html"><a href="visualisation.html#modifiers"><i class="fa fa-check"></i><b>8.6</b> Modifiers</a><ul>
<li class="chapter" data-level="8.6.1" data-path="visualisation.html"><a href="visualisation.html#scales"><i class="fa fa-check"></i><b>8.6.1</b> Scales</a></li>
<li class="chapter" data-level="8.6.2" data-path="visualisation.html"><a href="visualisation.html#labels"><i class="fa fa-check"></i><b>8.6.2</b> Labels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="text-1.html"><a href="text-1.html"><i class="fa fa-check"></i><b>9</b> Text</a><ul>
<li class="chapter" data-level="9.1" data-path="text-1.html"><a href="text-1.html#regular-expressions-regex"><i class="fa fa-check"></i><b>9.1</b> Regular Expressions (regex)</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Python for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pandas" class="section level1">
<h1><span class="header-section-number">7</span> Pandas</h1>
<p>The pandas package was written by Wes McKinney (who seems to be <em>Hadley Wickham’s</em> counterpart for <strong>Python</strong>) and builds on top of the numpy package to provide DataFrames.</p>
<div id="creation" class="section level2">
<h2><span class="header-section-number">7.1</span> Creation</h2>
<p>To create a DataFrame manually:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
mydict <span class="op">=</span> {
  <span class="st">&quot;country&quot;</span>:    [<span class="st">&#39;Brazil&#39;</span>,   <span class="st">&#39;Russia&#39;</span>, <span class="st">&#39;India&#39;</span>,     <span class="st">&#39;China&#39;</span>,   <span class="st">&#39;South Africa&#39;</span>],
  <span class="st">&quot;capital&quot;</span>:    [<span class="st">&#39;Brasilia&#39;</span>, <span class="st">&#39;Moscow&#39;</span>, <span class="st">&#39;New Delhi&#39;</span>, <span class="st">&#39;Beijing&#39;</span>, <span class="st">&#39;Pretoria&#39;</span>    ],
  <span class="st">&quot;area&quot;</span>:       [ <span class="fl">8.516</span>,      <span class="fl">17.10</span>,    <span class="fl">3.286</span>,       <span class="fl">9.597</span>,     <span class="fl">1.221</span>        ],
  <span class="st">&quot;population&quot;</span>: [ <span class="fl">200.4</span>,      <span class="fl">143.5</span>,    <span class="dv">1252</span>,        <span class="dv">1357</span>,      <span class="fl">52.98</span>        ]}
df <span class="op">=</span> pd.DataFrame(mydict)
df.index      <span class="op">=</span> [<span class="st">&#39;BR&#39;</span>,       <span class="st">&#39;RU&#39;</span>,     <span class="st">&#39;IN&#39;</span>,        <span class="st">&#39;CH&#39;</span>,      <span class="st">&#39;SA&#39;</span>          ]
<span class="bu">print</span>(df)</code></pre></div>
<pre><code>##          country    capital    area  population
## BR        Brazil   Brasilia   8.516      200.40
## RU        Russia     Moscow  17.100      143.50
## IN         India  New Delhi   3.286     1252.00
## CH         China    Beijing   9.597     1357.00
## SA  South Africa   Pretoria   1.221       52.98</code></pre>
<p>Alternatively, if you have data in a CSV file you can import it using:</p>
<pre><code>df = pd.read_csv(&#39;&lt;path&gt;&#39;)                # If there are no column names
df = pd.read_csv(&#39;&lt;path&gt;&#39;, index_col = 0) # If there are column names</code></pre>
<p>You can also create a DataFrame as a list of lists:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> pandas <span class="im">as</span> pd
cities <span class="op">=</span> [<span class="st">&#39;Austin&#39;</span>, <span class="st">&#39;Dallas&#39;</span>, <span class="st">&#39;Austin&#39;</span>, <span class="st">&#39;Dallas&#39;</span>]
signups <span class="op">=</span> [<span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">5</span>]
visitors <span class="op">=</span> [<span class="dv">139</span>, <span class="dv">237</span>, <span class="dv">326</span>, <span class="dv">456</span>]
weekdays <span class="op">=</span> [<span class="st">&#39;Sun&#39;</span>, <span class="st">&#39;Sun&#39;</span>, <span class="st">&#39;Mon&#39;</span>, <span class="st">&#39;Mon&#39;</span>]
list_labels <span class="op">=</span> [<span class="st">&#39;city&#39;</span>, <span class="st">&#39;signups&#39;</span>, <span class="st">&#39;visitors&#39;</span>, <span class="st">&#39;weekday&#39;</span>]
list_cols <span class="op">=</span> [cities, signups, visitors, weekdays]
zipped <span class="op">=</span> <span class="bu">list</span>(<span class="bu">zip</span>(list_labels, list_cols))
data <span class="op">=</span> <span class="bu">dict</span>(zipped)
users <span class="op">=</span> pd.DataFrame(data)
<span class="bu">print</span>(users)</code></pre></div>
<pre><code>##      city  signups  visitors weekday
## 0  Austin        7       139     Sun
## 1  Dallas       12       237     Sun
## 2  Austin        3       326     Mon
## 3  Dallas        5       456     Mon</code></pre>
</div>
<div id="subsetting" class="section level2">
<h2><span class="header-section-number">7.2</span> Subsetting</h2>
<p>To select a column in pandas, use <code>df['country']</code>. This returns a “pandas Series” object, which is like a 1D element of a data frame. If you want to get a data frame back instead of a series, use <code>df[['country']]</code>. This is the opposite of <strong>R</strong>, where the <code>[[]]</code> is used to drill down further than <code>[]</code>. The reason for this is that <code>[]</code> defines a list in <strong>Python</strong>, so you’re really calling <code>df[&lt;subset&gt;]</code> where <code>&lt;subset&gt;</code> is a list of length 1. In <strong>R</strong>, the <code>[[]]</code> subset operator is actually a function, hence the differing behaviours. This means that subsetting for multiple columns in Python doesn’t take too much writing: <code>df[['country', 'capital']]</code>.</p>
<p>Interestingly, and perhaps confusingly, if you provide a slice (range) to <code>df[]</code> then you will be subsetting on rows, not columns! Using <code>df[1:4]</code> selects the 2nd through 4th rows of the data frame.</p>
<p>If you want to do anything more complex than this, it starts getting a bit weird, and you have to use the <code>loc()</code> method (which stands for “location”). To pull out a named row, you need to use the <code>df.loc['RU']</code> syntax (which returns a Series object), or <code>df.loc[['RU']]</code> (which returns a DataFrame). You can also select multiple rows this way: <code>df.loc[['RU', 'IN', 'CH']]</code>. You can then extend this to subset on columns as well, which starts to look a bit more like <strong>R</strong> (and like the 2D numpy array): <code>df.loc[['RU', 'IN', 'CH'], ['country', 'capital']]</code>.</p>
<p>If you want to use an index, then you can do the same thing with lists of integers passed to the <code>iloc()</code> method (which stands for index-location). It seems like you probably need to chain these functions together if you want to have a mix of subsetting approaches.</p>
</div>
<div id="reading-in-chunks" class="section level2">
<h2><span class="header-section-number">7.3</span> Reading in chunks</h2>
<p>You can use the <code>chunksize</code> argument to read a CSV file in chunks, then iterate over the chunks in a loop. This can be useful when you’re dealing with large amounts of data that won’t fit in memory.</p>
<pre><code>import pandas as pd
result = []
for chunk in pd.read_csv(&#39;data.csv&#39;, chunksize = 1000) :
  result.append(sun(chunk[&#39;x&#39;]))
total = sum(result)
print(total)</code></pre>
</div>
<div id="working-with-dataframes" class="section level2">
<h2><span class="header-section-number">7.4</span> Working with DataFrames</h2>
<div id="basics" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Basics</h3>
<p>You can print the head or tail of a DataFrame using <code>.head()</code> and <code>.tail()</code> respectively. You can inspect the shape of the DataFrame by accessing the <code>.shape</code> attribute and get the names of the columns using <code>.columns</code>.</p>
<pre><code># Import pandas
import pandas as pd

# Read the file into a DataFrame: df
df = pd.read_csv(&#39;dob_job_application_filings_subset.csv&#39;)

# Print the head of df
print(df.head())

# Print the tail of df
print(df.tail())

# Print the shape of df
print(df.shape)

# Print the columns of df
print(df.columns)</code></pre>
<p>The <code>.info()</code> method gives you a summary of the DataFrame.</p>
<pre><code>print(df.info())</code></pre>
<pre><code>    &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
    RangeIndex: 12846 entries, 0 to 12845
    Data columns (total 13 columns):
    Job #                      12846 non-null int64
    Doc #                      12846 non-null int64
    Borough                    12846 non-null object
    Initial Cost               12846 non-null object
    Total Est. Fee             12846 non-null object
    Existing Zoning Sqft       12846 non-null int64
    Proposed Zoning Sqft       12846 non-null int64
    Enlargement SQ Footage     12846 non-null int64
    Street Frontage            12846 non-null int64
    ExistingNo. of Stories     12846 non-null int64
    Proposed No. of Stories    12846 non-null int64
    Existing Height            12846 non-null int64
    Proposed Height            12846 non-null int64
    dtypes: int64(10), object(3)
    memory usage: 1.3+ MB
    None</code></pre>
<p>For more detailed statistics about numeric columns, you can also use the <code>.describe()</code> method.</p>
</div>
<div id="selecting-columns" class="section level3">
<h3><span class="header-section-number">7.4.2</span> Selecting Columns</h3>
<p>If the column name does not contain any special characters or spaces, and is not the name of a Python function, then you can access columns as attributes. For example, this means that <code>df.continent</code> and <code>df['continent']</code> are equivalent.</p>
</div>
<div id="counting-values" class="section level3">
<h3><span class="header-section-number">7.4.3</span> Counting Values</h3>
<p>You can use the <code>.value_counts()</code> method on a column (AKA Series) to count and sort occurrences of each value in the column.</p>
<pre><code># Print the value counts for &#39;Site Fill&#39;
print(df[&#39;State&#39;].value_counts(dropna=False))</code></pre>
<pre><code>    Name: State, dtype: int64
    NOT APPLICABLE                              7806
    NaN                                         4205
    ON-SITE                                      519
    OFF-SITE                                     186
    USE UNDER 300 CU.YD                          130</code></pre>
</div>
<div id="plotting-things" class="section level3">
<h3><span class="header-section-number">7.4.4</span> Plotting Things</h3>
<p>Pandas has tight integration with <strong>matplotlib</strong> which allows you to call plotting methods on columns directly.</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt

df.population.plot(&#39;hist&#39;)
plt.show()

df.boxplot(column = &#39;population&#39;, by = &#39;continent&#39;)
plt.show()

df.plot(kind=&#39;scatter&#39;, x=&#39;initial_cost&#39;, y=&#39;total_est_fee&#39;, rot=70)
plt.show()</code></pre>
</div>
<div id="reshaping-data-tidy-data" class="section level3">
<h3><span class="header-section-number">7.4.5</span> Reshaping Data (Tidy Data)</h3>
<p>The <code>pd.melt()</code> function is functionally similar to the <code>tidyr::gather()</code> function in <strong>R</strong> in that it takes a “wide” data representation and gathers the columns into a “narrow” representation.</p>
<p>From DataCamp:</p>
<blockquote>
<p>There are two parameters you should be aware of: <code>id_vars</code> and <code>value_vars</code>. The <code>id_vars</code> represent the columns of the data you do not want to melt (i.e., keep it in its current shape), while the <code>value_vars</code> represent the columns you do wish to melt into rows. By default, if no <code>value_vars</code> are provided, all columns not set in the <code>id_vars</code> will be melted. This could save a bit of typing, depending on the number of columns that need to be melted. You can rename the variable column by specifying an argument to the <code>var_name</code> parameter, and the value column by specifying an argument to the <code>value_name</code> parameter.</p>
</blockquote>
<p>You can then use <code>pd.melt()</code> like this:</p>
<pre><code>print(airquality.head())
airquality_melt = pd.melt(airquality, 
                          id_vars=[&#39;Month&#39;, &#39;Day&#39;], 
                          var_name=&#39;measurement&#39;, 
                          value_name=&#39;reading&#39;)
print(airquality_melt.head())</code></pre>
<pre><code>       Ozone  Solar.R  Wind  Temp  Month  Day
    0   41.0    190.0   7.4    67      5    1
    1   36.0    118.0   8.0    72      5    2
    2   12.0    149.0  12.6    74      5    3
    3   18.0    313.0  11.5    62      5    4
    4    NaN      NaN  14.3    56      5    5
       Month  Day measurement  reading
    0      5    1       Ozone     41.0
    1      5    2       Ozone     36.0
    2      5    3       Ozone     12.0
    3      5    4       Ozone     18.0
    4      5    5       Ozone      NaN</code></pre>
<p>To go the other way, i.e. to “spread” the table (like <code>tidyr::spread()</code> in <strong>R</strong>) you need to use the <code>.pivot()</code> or <code>.pivot_table()</code> method on the DataFrame object. The main difference between these two methods seems to be that <code>.pivot()</code> cannot deal with duplicate values, where <code>.pivot_table()</code> allows you to pass in an aggregation function to handle duplicates (via the <code>aggfunc</code> argument). <code>.pivot_table()</code> also allows you to pass multiple index columns.</p>
<pre><code>print(airquality_melt.head())
airquality_pivot = airquality_melt.pivot(index=[&#39;Month&#39;, &#39;Day&#39;], 
                                         columns=&#39;measurement&#39;, 
                                         values=&#39;reading&#39;)
print(airquality_pivot.head())</code></pre>
<pre><code>       Month  Day measurement  reading
    0      5    1       Ozone     41.0
    1      5    2       Ozone     36.0
    2      5    3       Ozone     12.0
    3      5    4       Ozone     18.0
    4      5    5       Ozone      NaN
    measurement  Ozone  Solar.R  Temp  Wind
    Month Day                              
    5     1       41.0    190.0  67.0   7.4
          2       36.0    118.0  72.0   8.0
          3       12.0    149.0  74.0  12.6
          4       18.0    313.0  62.0  11.5
          5        NaN      NaN  56.0  14.3</code></pre>
<p>Note that this DataFrame looks a bit different, because it has a <strong>hierarchical index</strong> (AKA <strong>MultiIndex</strong>) which seems to be how <strong>pandas</strong> implements grouping. You can remove this by calling the <code>.reset_index()</code> method on the DataFrame.</p>
<pre><code>print(airquality_pivot.index)
airquality_pivot_reset = airquality_pivot.reset_index()
print(airquality_pivot_reset.index)
print(airquality_pivot_reset.head())</code></pre>
<pre><code>    MultiIndex(levels=[[5, 6, 7, 8, 9], [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]],
               labels=[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29]],
               names=[&#39;Month&#39;, &#39;Day&#39;])
    RangeIndex(start=0, stop=153, step=1)
    measurement  Month  Day  Ozone  Solar.R  Temp  Wind
    0                5    1   41.0    190.0  67.0   7.4
    1                5    2   36.0    118.0  72.0   8.0
    2                5    3   12.0    149.0  74.0  12.6
    3                5    4   18.0    313.0  62.0  11.5
    4                5    5    NaN      NaN  56.0  14.3</code></pre>
</div>
<div id="chaining-methods" class="section level3">
<h3><span class="header-section-number">7.4.6</span> Chaining methods</h3>
<p>This is a cool bit of code, not sure where it belongs but I’ll stick it here for now until I write it into proper section.</p>
<pre><code># Melt ebola: ebola_melt
ebola_melt = pd.melt(ebola, id_vars=[&#39;Date&#39;, &#39;Day&#39;], var_name=&#39;type_country&#39;, value_name=&#39;counts&#39;)

# Create the &#39;str_split&#39; column
ebola_melt[&#39;str_split&#39;] = ebola_melt.type_country.str.split(&#39;_&#39;)

# Create the &#39;type&#39; column
ebola_melt[&#39;type&#39;] = ebola_melt.str_split.str.get(0)

# Create the &#39;country&#39; column
ebola_melt[&#39;country&#39;] = ebola_melt.str_split.str.get(1)

# Print the head of ebola_melt
print(ebola_melt.head())</code></pre>
<pre><code>             Date  Day  type_country  counts        str_split   type country
    0    1/5/2015  289  Cases_Guinea  2776.0  [Cases, Guinea]  Cases  Guinea
    1    1/4/2015  288  Cases_Guinea  2775.0  [Cases, Guinea]  Cases  Guinea
    2    1/3/2015  287  Cases_Guinea  2769.0  [Cases, Guinea]  Cases  Guinea
    3    1/2/2015  286  Cases_Guinea     NaN  [Cases, Guinea]  Cases  Guinea
    4  12/31/2014  284  Cases_Guinea  2730.0  [Cases, Guinea]  Cases  Guinea</code></pre>
</div>
<div id="concatenation" class="section level3">
<h3><span class="header-section-number">7.4.7</span> Concatenation</h3>
<p>You can join DataFrames together using the <code>pd.concat()</code> function, which seems like the equivalent of R’s <code>rbind()</code> and <code>cbind()</code> functions.</p>
<pre><code>row_bind_df = pd.concat([df1, df2])
col_bind_df = pd.concat([df1, df2], axis=1)</code></pre>
<p>Similar to the <strong>dplyr</strong> <code>bind_rows()</code> and <code>bind_cols()</code> functions, it looks like it helps you out by including the union of columns (rather than just the intersection) and uses <code>NaN</code> to fill in missing values.</p>
</div>
<div id="joining-merging" class="section level3">
<h3><span class="header-section-number">7.4.8</span> Joining (Merging)</h3>
<p>You can join DataFrames using the <code>pd.merge()</code> function.</p>
<pre><code>merged_df = pd.merge(left=df1, right=df2, left_on=&#39;key1&#39;, right_on=&#39;key2&#39;)</code></pre>
</div>
<div id="types-1" class="section level3">
<h3><span class="header-section-number">7.4.9</span> Types</h3>
<p>You can change the type of a column in a DataFrame using the <code>.astype()</code> method.</p>
<pre><code>df1.col1 = df1.col1.astype(&#39;category&#39;)</code></pre>
<p>There are also some more feature-rich conversion functions which allow you to specify how edge-cases are handled. One such function is <code>pd.to_numeric()</code>.</p>
<pre><code>df1[&#39;col1&#39;] = pd.to_numeric(df1[&#39;col1&#39;], errors=&#39;coerce&#39;)</code></pre>
</div>
<div id="apply" class="section level3">
<h3><span class="header-section-number">7.4.10</span> Apply</h3>
<p>You can use the <code>.apply()</code> method to a DataFrame to apply a function to cols (axis=0) or rows (axis=1). You can also apply to a Series directly.</p>
<p>Some examples:</p>
<pre><code># Normal function applied to a Series
def recode_col1(value) :
    # this function does nothing
    return value
    
df1[&#39;col1_recode&#39;] = df1.col1.apply(recode_col1)</code></pre>
<pre><code># Lambda function applied to a series (basically removes dollar signs)
d1[&#39;col1_re&#39;] = df[&#39;col1&#39;].apply(lambda x: re.findall(&#39;\d+\.\d+&#39;, x)[0])</code></pre>
</div>
<div id="duplicates" class="section level3">
<h3><span class="header-section-number">7.4.11</span> Duplicates</h3>
<p>Pandas DataFrames have a <code>.drop_duplicates()</code> method which you can apply to a DataFrame to remove duplicates.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="numpy-numeric-python.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/perrystephenson/py4ds/edit/master/06-pandas.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
